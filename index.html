<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto HTML Compiler</title>
</head>
<body>
    <input type='file' class='file-input' onchange='loadFile(event)' hidden>
    <center>
        <iframe src="" frameborder="0" id="iframe"></iframe>
    </center>
        <p style="font-family: 'Courier New', Courier, monospace;">Auto Compile? <input id='check' type="checkbox" style='cursor: pointer;'><br><button onclick="Run()" id='rn'>Run</button><br><button style='margin-top: 10px;' onclick="Download()" id='rn'>Download Code</button></p>
    <center>
        <textarea id="HTML" onkeyup="Compile()" placeholder="Enter Your HTML Code Here..." spellcheck="false"></textarea>
        <br>
        <textarea id='CSS' onkeyup="Compile()" placeholder="Enter CSS Code Here..." spellcheck="false"></textarea>
        <br>
        <textarea id='JS' onkeyup="Compile()" placeholder="Enter JavaScript Here..." spellcheck="false"></textarea>
        <br>
        <button style='margin-top: 10px;' onclick="loadFromURL()" id='rn'>Load From URL</button>
        <button style='margin-top: 10px;' onclick="loadFromFile()" id='rn'>Load From File</button>
        <button style='margin-top: 10px;' onclick="openInNewWindow()" id='rn' class='open-new-window'>Open Preview In New Window</button>
        <br/><br/>
        <a target="_blank" href="https://github.com/sancho1952007/Auto-HTML-Compiler">Star On Github</a>
        <br/><br/>
        <a target="_blank" href="https://sancho1952007.github.io/">Built with ❤️ by Sancho</a>
    </center>
</body>
<style>
    textarea{
        width: 99%;
        resize: none;
        height: 30vh;
        border-radius: 10px;
        outline: none;
    }
    #iframe{
        border: 1px solid black;
        width: 99%;
        height: 70vh;
    }
    #check{
        outline: none;
    }
    #rn{
        text-align: center;
        width: 99%;
        background-color: lightgrey;
        border: 1px solid;
        cursor: pointer;
    }
    a{
        font-family: 'Courier New', Courier, monospace;
    }
</style>
<script type="text/javascript" src='compile.js'>
</script>

<script>
    var openInNewWindowBtn=document.querySelector('.open-new-window')
    var liveCompile=document.querySelector('#check');
    var file=document.querySelector('.file-input');
    var HTML=document.querySelector('#HTML');
    var CSS=document.querySelector('#CSS');
    var JS=document.querySelector('#JS');

    function loadFromURL(){
        URL=prompt('Enter URL:')
        if (URL.replace(/\s+/g, '').length == 0) {
            alert('Please enter a valid URL!')
        }

        else{
            try{
                var request = null;
                request=new XMLHttpRequest();
                request.open('GET', URL, false);
                request.send(null);
                HTML.value=(request.responseText);
                console.clear();
            }
            catch{
                alert('Error Processing Request!')
            }
        }

        Compile();
    }

    function loadFromFile(){
        file.click();
    }

    function loadFile(event){
        var contentURL = URL.createObjectURL(event.target.files[0]);
        fetch(contentURL).then(function(response) {
            return response.text();
        }).then(function(text) {
            HTML.value=text;
        });
        console.clear();

        Compile();
    }

    function closeNewWindowPreview(){
        preview.close();
        openInNewWindowBtn.innerHTML='Open Preview In New Window';
        openInNewWindowBtn.onclick=openInNewWindow();
    }

    function openInNewWindow(){
        var preview=window.open("", '_blank');
        preview.document.write(`${HTML.value}\n<style>\n${CSS.value}\n</style>\n<script>${JS.value}\n<\/script>`);
        openInNewWindowBtn.innerHTML = "Close New Window Preview";
        openInNewWindowBtn.onclick=closeNewWindowPreview();
    }
</script>

</html>


